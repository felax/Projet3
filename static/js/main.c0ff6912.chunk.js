(this.webpackJsonpamplifyapp=this.webpackJsonpamplifyapp||[]).push([[0],{48:function(t,e,r){},50:function(t,e,r){},51:function(t,e,r){"use strict";r.r(e);var a=r(4),n=r.n(a),i=r(35),s=r.n(i),o=r(10),c=r(6),d=r(7),l=r(13),p=r(9),u=r(8),h=r(41),f=r(19),m=r(36),b=(r(48),r(39));function j(t,e){var r=1/0,a=-1/0;return t.forEach((function(t){var n=function(t){var e=t.offset;return[e,t.step?e+t.yData.length*t.step:e+t.xData[t.xData.length-1]]}(e[t]);n[0]<r&&(r=n[0]),n[1]>a&&(a=n[1])})),[r,a]}function x(t,e){for(var r=t[0],a=t[1],n=[];r<a;)n.push(r),r+=e;return n}var v=r(1);function O(t){return Object(v.jsxs)("div",{style:{color:t.item.color,fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden"},children:[Object(v.jsx)("button",{onClick:function(e){t.delItem(t.item.id)},children:"x"}),t.item.name]})}var g=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){return Object(c.a)(this,r),e.apply(this,arguments)}return Object(d.a)(r,[{key:"render",value:function(){var t=this,e=this.props.graph.items.map((function(e){var r=t.props.items[e];return Object(v.jsx)(O,{item:r,delItem:function(e){return t.props.updGraphItem({graphId:t.props.graph.id,itemId:e,add:!1})}},r.id)}));return Object(v.jsxs)("div",{style:{border:"1px solid gray",resize:"vertical",overflow:"hidden",height:"200px",display:"flex",flexDirection:"row"},onDragOver:function(t){return t.preventDefault()},onDrop:function(e){e.preventDefault();var r=Number(e.dataTransfer.getData("text"));t.props.graph.items.includes(r)||t.props.updGraphItem({graphId:t.props.graph.id,itemId:r,add:!0})},children:[Object(v.jsxs)("div",{style:{flex:"0 0 150px",display:"flex",flexDirection:"column"},children:[Object(v.jsx)("div",{style:{flex:"1 1",display:"flex",flexDirection:"column"},children:e}),Object(v.jsx)("div",{style:{flex:"0 0 30px"},children:Object(v.jsx)("button",{type:"button",onClick:function(){return t.props.delGraph(t.props.graph.id)},children:"\u274c"})})]}),Object(v.jsx)("div",{id:"dy"+String(this.props.graph.id),style:{width:"calc(100% - 150px)",paddingBottom:"20px"}})]})}},{key:"componentDidMount",value:function(){this.dygraph=new m.a("dy"+String(this.props.graph.id),[[0,0]],{labels:["x","y"],legend:"follow",connectSeparatedPoints:!0})}},{key:"componentDidUpdate",value:function(){var t=this;console.log("UPDATING GRAPHS");var e=this.props.step,r=j(this.props.graph.items,this.props.items),a=["x"],n=[],i=[x(r,e)];this.props.graph.items.forEach((function(s){var o=t.props.items[s];n.push(o.color),a.push(o.name),i.push(function(t,e,r){var a=e[0],n=e[1],i=Math.round((n-a)/r),s=new Array(i).fill(null);return t.yData.forEach((function(e,n){var i=(t.step?n*t.step:t.xData[n])+t.offset,o=Math.round((i-a)/r);s[o]=e})),s}(o,r,e))}));var s=function(t){for(var e=[],r=0;r<t[0].length;r++){e.push([]);var a,n=Object(b.a)(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;e[r].push(i[r])}}catch(s){n.e(s)}finally{n.f()}}return e}(i);a.length<=1&&(a.push("y"),s=[[0,0]]),this.dygraph.updateOptions({file:s,labels:a,colors:n,dateWindow:this.props.bounds,axes:{x:{drawAxis:this.props.drawX},y:{drawAxis:this.props.drawY}}})}}]),r}(n.a.Component);var y=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(t){var a;return Object(c.a)(this,r),(a=e.call(this,t)).state={step:1e-5,drawX:!0,drawY:!0},a}return Object(d.a)(r,[{key:"render",value:function(){var t=this,e=j(function(t){var e=[];return Object.values(t).forEach((function(t){t.items.forEach((function(t){e.includes(t)||e.push(t)}))})),e}(this.props.graphs),this.props.items),r=Object.entries(this.props.graphs).map((function(r){var a=Object(f.a)(r,2),n=a[0],i=a[1];return Object(v.jsx)(g,{delGraph:t.props.delGraph,updGraphItem:t.props.updGraphItem,items:t.props.items,graph:i,bounds:e,step:t.state.step,drawX:t.state.drawX,drawY:t.state.drawY},n)}));return Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",overflow:"auto"},children:[Object(v.jsxs)("div",{style:{flex:"0 0 20px",border:"1px solid"},children:[Object(v.jsx)("button",{onClick:this.props.addGraph,children:"+"}),Object(v.jsx)("input",{type:"number",step:"any",defaultValue:this.state.step,onBlur:function(e){t.setState({step:Number(e.target.value)}),console.log(e)}}),Object(v.jsx)("input",{type:"checkbox",defaultChecked:!0,onClick:function(e){t.setState({drawX:e.target.checked})}}),Object(v.jsx)("input",{type:"checkbox",defaultChecked:!0,onChange:function(e){t.setState({drawY:e.target.checked})}})]}),r]})}}]),r}(n.a.Component),I=r(40),w=r.n(I);function k(t,e){var r=Math.floor(Math.random()*(e-t)+t),a=Math.floor(Math.random()*(e-t)+t),n=Math.floor(Math.random()*(e-t)+t);return"#"+r.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")+n.toString(16).padStart(2,"0")}var D=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){var t;Object(c.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))).handleFileSelect=function(e){"DEFAULT"!==e.target.value&&(t.format=e.target.value,t.fileSelector.click(),e.target.value="DEFAULT")},t}return Object(d.a)(r,[{key:"componentDidMount",value:function(){var t=this;this.fileSelector=document.createElement("input"),this.fileSelector.setAttribute("type","file"),this.fileSelector.setAttribute("accept",".csv"),this.fileSelector.addEventListener("change",(function(e){!function(t,e,r){var a=t.target.files[0],n=new FileReader;n.addEventListener("load",(function(t){console.log("Loading CSV into array...");var a=w.a.parse(t.target.result,{skipEmptyLines:!0}).data;console.log("Parsing CSV array..."),"tek"===r?e(function(t){for(var e=Number(t[1][1]),r=Number(t[0][1]),a=t[4][0],n=[],i=0;i<r;i++)n.push(Number(t[i][4]));return{name:a,yData:n,step:e,color:k(0,155),offset:0}}(a)):"custom"===r&&e(function(t){var e=[],r=[];return t.forEach((function(t){e.push(Number(t[0])),r.push(Number(t[1]))})),{name:"Custom",xData:e,yData:r,color:k(0,155),offset:0}}(a))})),n.readAsText(a)}(e,t.props.addItem,t.format)}))}},{key:"render",value:function(){return Object(v.jsxs)("select",{onChange:this.handleFileSelect,defaultValue:"DEFAULT",children:[Object(v.jsx)("option",{value:"DEFAULT",disabled:!0,hidden:!0,children:"Add"}),Object(v.jsx)("option",{value:"tek",children:"Tektronix"}),Object(v.jsx)("option",{value:"custom",children:"Custom"})]})}}]),r}(n.a.Component);var S=function(t){return Object(v.jsxs)("div",{style:{display:"flex",border:"1px solid black",flex:"0 0 30px",alignItems:"center",margin:"2px"},children:[Object(v.jsx)("div",{style:{flex:"0 0 30px",padding:"4px",borderRight:"1px solid"},children:Object(v.jsx)("input",{type:"color",draggable:"true",defaultValue:t.item.color,onChange:function(e){return t.updItem({color:e.target.value,id:t.item.id})},onDragStart:function(e){return e.dataTransfer.setData("text",t.item.id)}})}),Object(v.jsxs)("div",{style:{flex:"1 1",overflow:"hidden",padding:"4px",whiteSpace:"nowrap"},children:[Object(v.jsx)("input",{type:"text",defaultValue:t.item.name,onBlur:function(e){return t.updItem({name:e.target.value,id:t.item.id})}}),Object(v.jsx)("input",{type:"number",placeholder:"xOffset",step:"any",onBlur:function(e){return t.updItem({offset:Number(e.target.value),id:t.item.id})}}),Object(v.jsx)("button",{type:"button",children:"\ud83d\udec8"}),Object(v.jsx)("button",{type:"button",onClick:function(){return t.delItem(t.item.id)},children:"\u274c"})]})]})};var G=function(t){var e=Object.values(t.items).map((function(e){return Object(v.jsx)(S,{item:e,updItem:t.updItem,delItem:t.delItem},e.id)}));return Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",borderWidth:"thin",border:"1px solid black"},children:[Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",border:"1px solid black",flex:"0 0 20px"},children:Object(v.jsx)(D,{addItem:t.updItem})}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:"1 1"},children:e})]})},E=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(){return Object(c.a)(this,r),e.apply(this,arguments)}return Object(d.a)(r,[{key:"render",value:function(){return Object(v.jsx)("div",{style:{flex:"1 1 100px",borderWidth:"thin",borderStyle:"solid"}})}}]),r}(n.a.Component),C=function(t){Object(p.a)(r,t);var e=Object(u.a)(r);function r(t){var a;return Object(c.a)(this,r),(a=e.call(this,t)).state={items:{},nItems:0,graphs:{},nGraphs:0},a.updItem=a.updItem.bind(Object(l.a)(a)),a.delItem=a.delItem.bind(Object(l.a)(a)),a.addGraph=a.addGraph.bind(Object(l.a)(a)),a.delGraph=a.delGraph.bind(Object(l.a)(a)),a.updGraphItem=a.updGraphItem.bind(Object(l.a)(a)),a}return Object(d.a)(r,[{key:"updItem",value:function(t){var e=Object(o.a)({},this.state.items);e.hasOwnProperty(t.id)?e[t.id]=Object(o.a)(Object(o.a)({},e[t.id]),t):(t.id=this.state.nItems+1,e[t.id]=t),this.setState({items:e,nItems:t.id})}},{key:"delItem",value:function(t){console.log("DELETING"),console.log(t);var e=Object(o.a)({},this.state.items);delete e[t];var r=Object(o.a)({},this.state.graphs);Object.values(r).forEach((function(e){e.items.includes(t)&&e.items.splice(e.items.indexOf(t),1)})),this.setState({items:e,graphs:r})}},{key:"addGraph",value:function(){var t=Object(o.a)({},this.state.graphs),e=this.state.nGraphs+1;t[e]={id:e,items:[]},this.setState({graphs:t,nGraphs:e}),console.log("Adding Graphs:"),console.log(t)}},{key:"delGraph",value:function(t){var e=Object(o.a)({},this.state.graphs);delete e[t],this.setState({graphs:e})}},{key:"updGraphItem",value:function(t){var e=t.graphId,r=t.itemId,a=t.add,n=Object(o.a)({},this.state.graphs),i=n[e];a?i.items.push(r):i.items.splice(i.items.indexOf(r),1),this.setState({graphs:n})}},{key:"render",value:function(){return Object(v.jsxs)(h.a,{sizes:[25,50,25],gutterAlign:"start",minSize:150,onDrag:function(){return window.dispatchEvent(new Event("resize"))},style:{display:"flex",flexDirection:"row"},children:[Object(v.jsx)(G,{items:this.state.items,updItem:this.updItem,delItem:this.delItem}),Object(v.jsx)(y,{items:this.state.items,graphs:this.state.graphs,addGraph:this.addGraph,delGraph:this.delGraph,updGraphItem:this.updGraphItem}),Object(v.jsx)(E,{})]})}}]),r}(n.a.Component);r(50);s.a.render(Object(v.jsx)(C,{}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.c0ff6912.chunk.js.map